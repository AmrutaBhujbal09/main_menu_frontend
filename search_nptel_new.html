<!DOCTYPE html>
<html>
<head>
<title>JavaScript - read JSON from URL</title>
<link rel="stylesheet" href="mystyle.css">
    
	
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	
</head>
<style>
.styled-table {
    border-collapse: collapse;
    margin: 25px 0;
    font-size: 0.9em;
    font-family: sans-serif;
    min-width: 100%;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
}

.navbar_header {
	margin-bottom:3%;
}

.styled-table thead tr {
    background-color: #009879;
    color: #ffffff;
    text-align: left;
}

.styled-table th,
.styled-table td {
    padding: 12px 15px;
	text-align: center;
}

.styled-table tbody tr {
    border-bottom: 1px solid #dddddd;
}

.styled-table tbody tr:nth-of-type(even) {
    background-color: #f3f3f3;
}

.styled-table tbody tr:last-of-type {
    border-bottom: 2px solid #009879;
}

.styled-table tbody tr.active-row {
    font-weight: bold;
    color: #009879;
}

.myForm{
	color: black;
	padding: 9px;
	font-size: 16px;
	position: relative;
	overflow: auto;
	z-index: 2;
	top:-19px;
	border: 2px;
	/*my corrections*/
	margin-bottom:-85px;
	
}



</style>
<body> 


<!--static menu code-->

<div id="header" onclick="window.location='http://google.com';">ICAT ARDE PUNE</div>
<div id="login" onclick="window.location='http://google.com';">LOGIN</div>
<div id="signup" onclick="window.location='http://google.com';">SIGN UP</div>

<div style="margin-top:-60px;padding:15px 15px 12px;font-size:15px;background-color:rgb(125, 189, 231);">
	<form class="example" action='file:///C:/Users/Imran%20Shaikh/Desktop/front.html'>
	  <input type="text" placeholder="Search.." name="search" id="search" style="margin-top:-45px;margin-left:12px;">
	  <button type="submit" onclick="myFunction()"><i class="fa fa-search"></i></button>
	</form>
</div>

<div class="tabs">
   
	 <button class="tablink" onclick="newwin()">All</button>  
	 <button class="tablink" onclick="newwindow()">NPTEL</button>
	 <button class="tablink" onclick='james()'>JANE'S </button>
	 <button class="tablink" onclick='arma()'>ARMABLOG</button>

	 <button class="tablink" onclick="libsys()">LIBSYS</button>
	 <button class="tablink" onclick="dspace()">DSPACE</button>
	<!--<button class="tablink" onclick="openTab(event,'NPTEL')">NPTEL</button>-->
</div>

<!--static menu js code-->
 
<body>
	<script type="text/javascript">
		function newwin(){
			window.open('front.html','_self','width=400,height=650');
			//tabcon = document.getElementByClassName("tabcontent");
		
		}

		function newwindow(){
			
			window.open('search_nptel_new.html','_self','width=400,height=650');
		}

		function james(){
		
			window.open('janes_HOMEPAGE.html','_self','width=400,height=650');
		}

		function arma(){
			
			window.open('welcome.html','_self','width=400,height=650');
		}

		function libsys(){
                
			window.open('welcome.html','_self','width=400,height=650');
		}
   
		function dspace(){
				   
			window.open('welcome.html','_self','width=400,height=650');
		}



	</script>
</body>
<!--<nav class="navbar navbar-default navbar-static-top"></nav>-->
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
     <!-- <a class="navbar-brand" href="#">ICAT ARDE PUNE</a>-->
	  <ul class="nav navbar-nav">
     <!--<li class="active"><a href="file:///C:/Users/Novetrics/Desktop/working/final/index.html">HOME</a></li>--> 
    </div>
	
<form class="myForm" method="post" action=""><br>
<select id="Coordinators" style="max-width:15%;" >
<option>Coordinators</option>
</select>
<select id="subjectName" style="max-width:15%;" >
<option>SubjectName</option>
</select>
<select id="disciplineName" style="max-width:15%;">
<option>DisciplineName</option>
</select>
<select id="institute" style="max-width:15%;">
<option>Institute</option>
</select>
<select id="filetype" style="max-width:15%;">
<option>FileType</option>
</select>
</form> 
<form class="navbar" action="#">
     <!--
		  <div class="input-group">
        <input type="text" class="form-control" placeholder="Search" name="search">
        <div class="input-group-btn">
          <button class="btn btn-default" type="submit">
            <i class="glyphicon glyphicon-search"></i>
          </button>
        </div>	
      </div>-->
    </form>	
    
  </div>
</nav>
<script>
const Coordinators_url = 
	"http://127.0.0.1:5000/coordinators"; 
const disciplineName_url = 
	"http://127.0.0.1:5000/disciplineName"; 
const SubjectName_url = 
	"http://127.0.0.1:5000/subjectName"; 
const Institute_url = 
	"http://127.0.0.1:5000/institute";
const filetype_url = 
	"http://127.0.0.1:5000/filetype"; 
var data
async function getCoordinators(url) { 
	const response = await fetch(url); 
	data = await response.json(); 
	// Display the list of array objects
	console.log(data);
	// Declare a new array
	let newArray = [];
	// Declare an empty object
	let uniqueObject = {};
	// Loop for the array elements
	for (let i in data) {
		// Extract the title
		objTitle = data[i]['coordinators'];

		// Use the title as the index
		uniqueObject[objTitle] = data[i];
	}
	// Loop to push unique object into array
	for (i in uniqueObject) {
		newArray.push(uniqueObject[i]);
	}
	// Display the unique objects
	console.log(newArray);
	//Coordinators
	var dropdown = document.getElementById("Coordinators");
	for (var i = 0; i < newArray.length; ++i) {
		dropdown.innerHTML = dropdown.innerHTML +
                '<option value="' + newArray[i]['id'] + '">' + newArray[i]['coordinators'] + '</option>';		
	}	
	dropdown.onchange = function(){
		var selectedString = dropdown.options[dropdown.selectedIndex].value;
		//alert(selectedString);	
		var strUser = dropdown.value;
		//console.log(strUser)
		var selValue = dropdown.options[dropdown.selectedIndex].text; // show selected text 
		console.log(selValue)

	}	
	var url = "http://127.0.0.1:5000/coordinators";
	var params = "Coordinators=";
	http.open("POST", url, true);

	//Send the proper header information along with the request
	http.setRequestHeader("Content-type", "t");
	http.setRequestHeader("Content-length", params.length);
	http.setRequestHeader("Connection", "close");

	http.onreadystatechange = function() {//Call a function when the state changes.
		if(http.readyState == 4 && http.status == 200) {
			alert(http.responseText);
		}
	}
http.send(params);
	

}

async function getdisciplineName(url) { 
	const response = await fetch(url); 
	data = await response.json(); 
	// Display the list of array objects
	console.log(data);
	// Declare a new array
	let newArray = [];
	// Declare an empty object
	let uniqueObject = {};
	// Loop for the array elements
	for (let i in data) {
		// Extract the title
		objTitle = data[i]['disciplineName'];

		// Use the title as the index
		uniqueObject[objTitle] = data[i];
	}
	// Loop to push unique object into array
	for (i in uniqueObject) {
		newArray.push(uniqueObject[i]);
	}
	// Display the unique objects
	console.log(newArray);
	//disciplineName
	var dropdown = document.getElementById("disciplineName");
	for (var i = 0; i < newArray.length; ++i) {
		dropdown.innerHTML = dropdown.innerHTML +
                '<option value="' + newArray[i]['id'] + '">' + newArray[i]['disciplineName'] + '</option>';		
	}	
	dropdown.onchange = function(){
		var selectedString = dropdown.options[dropdown.selectedIndex].value;
		//alert(selectedString);	
		var strUser = dropdown.value;
		//console.log(strUser)
		var selValue = dropdown.options[dropdown.selectedIndex].text; // show selected text 
		console.log(selValue)

	}	
}

async function getsubjectName(url) { 
	const response = await fetch(url); 
	data = await response.json(); 
	// Display the list of array objects
	console.log(data);
	// Declare a new array
	let newArray = [];
	// Declare an empty object
	let uniqueObject = {};
	// Loop for the array elements
	for (let i in data) {
		// Extract the title
		objTitle = data[i]['subjectName'];

		// Use the title as the index
		uniqueObject[objTitle] = data[i];
	}
	// Loop to push unique object into array
	for (i in uniqueObject) {
		newArray.push(uniqueObject[i]);
	}
	// Display the unique objects
	console.log(newArray);
	//subjectName
	var dropdown = document.getElementById("subjectName");
	for (var i = 0; i < newArray.length; ++i) {
		dropdown.innerHTML = dropdown.innerHTML +
                '<option value="' + newArray[i]['id'] + '">' + newArray[i]['subjectName'] + '</option>';		
	}	
	dropdown.onchange = function(){
		var selectedString = dropdown.options[dropdown.selectedIndex].value;
		//alert(selectedString);	
		var strUser = dropdown.value;
		//console.log(strUser)
		var selValue = dropdown.options[dropdown.selectedIndex].text; // show selected text 
		console.log(selValue)

	}	
}

async function getfiletype(url) { 
	const response = await fetch(url); 
	data = await response.json(); 
	// Display the list of array objects
	console.log(data);
	// Declare a new array
	let newArray = [];
	// Declare an empty object
	let uniqueObject = {};
	// Loop for the array elements
	for (let i in data) {
		// Extract the title
		objTitle = data[i]['filetype'];

		// Use the title as the index
		uniqueObject[objTitle] = data[i];
	}
	// Loop to push unique object into array
	for (i in uniqueObject) {
		newArray.push(uniqueObject[i]);
	}
	// Display the unique objects
	console.log(newArray);
	//filetype
	var dropdown = document.getElementById("filetype");
	for (var i = 0; i < newArray.length; ++i) {
		dropdown.innerHTML = dropdown.innerHTML +
                '<option value="' + newArray[i]['id'] + '">' + newArray[i]['filetype'] + '</option>';		
	}	
	dropdown.onchange = function(){
		var selectedString = dropdown.options[dropdown.selectedIndex].value;
		//alert(selectedString);	
		var strUser = dropdown.value;
		//console.log(strUser)
		var selValue = dropdown.options[dropdown.selectedIndex].text; // show selected text 
		console.log(selValue)

	}	
}

async function getinstitute(url) { 
	const response = await fetch(url); 
	data = await response.json(); 
	// Display the list of array objects
	console.log(data);
	// Declare a new array
	let newArray = [];
	// Declare an empty object
	let uniqueObject = {};
	// Loop for the array elements
	for (let i in data) {
		// Extract the title
		objTitle = data[i]['institute'];

		// Use the title as the index
		uniqueObject[objTitle] = data[i];
	}
	// Loop to push unique object into array
	for (i in uniqueObject) {
		newArray.push(uniqueObject[i]);
	}
	// Display the unique objects
	console.log(newArray);
	//institute
	var dropdown = document.getElementById("institute");
	for (var i = 0; i < newArray.length; ++i) {
		dropdown.innerHTML = dropdown.innerHTML +
                '<option value="' + newArray[i]['id'] + '">' + newArray[i]['institute'] + '</option>';		
	}	
	dropdown.onchange = function(){
		var selectedString = dropdown.options[dropdown.selectedIndex].value;
		//alert(selectedString);	
		var strUser = dropdown.value;
		//console.log(strUser)
		var selValue = dropdown.options[dropdown.selectedIndex].text; // show selected text 
		console.log(selValue)

	}	
}

//calling functins
getCoordinators(Coordinators_url); 
getdisciplineName(disciplineName_url); 
getsubjectName(SubjectName_url);
getinstitute(Institute_url) 
getfiletype(filetype_url) 

</script>  
<script>

var search=localStorage.getItem("q")
const api_url = 
	"http://127.0.0.1:5000/search?q="+search; 
var data
// Defining async function 
async function getapi(url) { 
	
	// Storing response 
	const response = await fetch(url); 
	
	// Storing data in form of JSON 
	data = await response.json(); 
	console.log(data); 
	if (response) { 
		hideloader(); 
	} 
	show(data); 
} 
// Calling that async function 
getapi(api_url); 

// Function to hide the loader 
function hideloader() { 
	document.getElementById('loading').style.display = 'none'; 
} 
// Function to define innerHTML for HTML table 
function show(data) { 
	let tab = 
		
		`<tr> 
		<th>Subject Name</th> 
		<th>File Path</th>
		<th>Lecture Name</th>
		<th>Lecture Path</th>
		</tr>`; 
	
	// Loop to access all rows 
	for (let r of data) { 
		console.log(r)
		tab += `<tr> 
	<td>${r.subjectName}</td> 
	<td><a href="${r.filepath}">${r.filepath}</td> 
	<td>${r.lect_name}</a></td>		 
	<td><a href="${r.lect_path}">${r.lect_path}</a></td>		 
</tr>`; 
	} 
	// Setting innerHTML as tab variable 
	document.getElementById("data").innerHTML = tab; 
} 
</script>
<!-- Here a loader is created which 
			loads till response comes -->
		<div class="d-flex justify-content-center"> 
			<div class="spinner-border"
				role="status" id="loading"> 
				<span class="sr-only" style="max-width:50%;">RESULTS NOT FOUND</span> 
			</div> 
		</div> 
		<!-- table for showing data -->
		<table id="data" class="styled-table"></table> 
</body> 
</html>